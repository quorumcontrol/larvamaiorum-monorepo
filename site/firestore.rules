rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    match /tables/{tableId=**} {
      allow read;
    }

    match /delphsLobby/{player} {
      allow read, list;
      allow write: if request.auth.uid == player;
    }

    match /tables/{tableId}/{player}/moves {
      allow write: if request.auth.uid == player && (player in get(/databases/$(database)/documents/tables/$(tableId)).data.players);
    }

    match /{document=**} {
      allow read, write: if false;
    }
  }
}